<!doctype html>
<html version="1000">
<head>
	<meta charset="utf-8">
	<title>ezSmartAtm Builder Form 새문서</title>
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="expires" content="0">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="author" content="[김윤섭][kkobiboy]">
	<link id="ui-style-core" rel="stylesheet" type="text/css" href="/core/app.controls.css">
	<script type="text/javascript" charset="utf-8" src="/HtaPlatform/Core/Form.JsApi"></script>
	<script type="text/javascript" charset="utf-8" src="/core/app.jquery.js"></script>
	<script type="text/javascript" charset="utf-8" src="/core/app.controls.js"></script>
	<style id="ui-style-user" type="text/css"></style>
	<script id="ui-script-user" type="text/javascript"></script>
</head>
<body oncontextmenu="return false;" class="ui-pre-load"><div class="ui-document ui-container" id="ui-document" lang="kr" ide-size="1506,1225" anchor="0b0101" dock="5" ui-id="Form" ui-class="UIForm" xonload="Form_OnLoad"><div class="ui-control ui-panel ui-container" id="ui-171be2e0c07" style="left: 0px; top: 0px; width: 1280px; height: 1024px; right: auto; bottom: auto; z-index: 0; background-color: transparent;" anchor="0b0101" dock="0" ui-id="PN_form" ui-class="UIPanel"><div class="ui-control ui-panel ui-container ui-dock ui-dock-top" id="ui-171be2e0c08" style="left: 0px; top: 0px; width: auto; height: 102px; right: 0px; bottom: auto; z-index: 0; background-color: rgb(23, 107, 200);" anchor="0b0101" dock="1" ui-id="PN_Title" ui-class="UIPanel" dock-w="200" dock-h="102" dock-r="left:98px;top:1px;width:200px;height:76px;right:auto;bottom:auto"><span class="ui-control ui-label" id="ui-171be2e0c09" style='left: 80px; top: 31px; width: 1120px; height: 40px; right: auto; bottom: auto; color: white; font-family: "IBK iDream M"; font-size: 38px; z-index: 0;' anchor="0b0101" dock="0" ui-id="LB_title" ui-class="UILabel"><span class="ui-content">결제정보변경</span></span></div><div class="ui-control ui-panel ui-container ui-dock ui-dock-top" id="ui-171a52210e4" style="left: 0px; top: 102px; width: auto; height: 92px; right: 0px; bottom: auto; z-index: 1; background-color: whitesmoke;" anchor="0b0101" dock="1" ui-id="PN_Subtitle" ui-class="UIPanel" dock-w="1280" dock-h="92" dock-r="left:0px;top:92px;width:1280px;height:112px;right:auto;bottom:auto"><span class="ui-control ui-label" id="ui-171a52210e5" style='left: 82px; top: 30px; width: 945px; height: 32px; right: auto; bottom: auto; font-family: "IBK iDream L"; font-size: 28px; z-index: 0;' anchor="0b0101" dock="0" ui-id="LB_Subtitle" ui-class="UILabel"><span class="ui-content">결제계좌를 선택해 주십시오.</span></span></div><div class="ui-control ui-panel ui-container ui-dock ui-dock-bottom" id="ui-171a4b083a4" style="left: 0px; top: auto; width: auto; height: 140px; right: 0px; bottom: 0px; z-index: 2; background-color: transparent;" anchor="0b0101" dock="2" ui-id="PN_btn" ui-class="UIPanel" dock-w="1280" dock-h="140" dock-r="left:0px;top:884px;width:1280px;height:140px;right:auto;bottom:auto"><span class="ui-control ui-button theme-blue" id="ui-171a4b083a5" style='left: auto; top: 31px; width: 258px; height: 80px; right: 36px; bottom: auto; font-family: "IBK iDream M"; font-size: 32px; z-index: 0;' anchor="0b1001" dock="0" ui-id="BT_right" ui-class="UIButton" xonclick="BT_right_OnClick" theme="blue"><span class="ui-content">확인</span></span><span class="ui-control ui-button theme-orange" id="ui-171a4b083a6" style='left: 36px; top: 31px; width: 258px; height: 80px; right: auto; bottom: auto; font-family: "IBK iDream M"; font-size: 32px; z-index: 1;' anchor="0b0101" dock="0" ui-id="BT_left" ui-class="UIButton" xonclick="BT_left_OnClick" theme="orange"><span class="ui-content">취소</span></span></div><div class="ui-control ui-panel ui-container ui-dock ui-dock-fill" id="ui-170cd1a2b22" style="left: 0px; top: 194px; width: auto; height: auto; right: 0px; bottom: 140px; z-index: 3;" anchor="0b0101" dock="5" ui-id="PN_contents" ui-class="UIPanel" dock-w="1280" dock-h="689" dock-r="left:0px;top:194px;width:1280px;height:689px;right:auto;bottom:auto"><span class="ui-control ui-scrollbar" id="ui-172980bda14" style="left: 1185px; top: 61px; width: 32px; height: 600px; right: auto; bottom: auto; z-index: 0;" anchor="0b0101" dock="0" ui-id="SB_scrollbar_acct" ui-class="UIScrollBar" scroll-control-id="PN_account"><span class="track"></span><span class="trackbutton"></span></span><div class="ui-control ui-panel ui-container" id="ui-170ec4084d5" style="left: 65px; top: 63px; width: 1076px; height: 587px; right: auto; bottom: auto; z-index: 1;" anchor="0b0101" dock="0" ui-id="PN_account" ui-class="UIPanel"></div></div></div>
</div><xcomponent></xcomponent><xjscript><script id='xjscript' type='text/plain'>// common.js import
importJSS("common", "common.js");

var p = parent;

function Form_OnLoad(e) {
	
}


function accountList(xioOutput){

    // 확인 버튼 비활성화
    BT_right.Enabled = false; 

	const records = xioOutput.Grid1;
	
	if(records.length <= 1){
        // 공통 메시지 화면 처리
        /***  20-09-22 이재형  ***/ 
        p.iwin9055.setErrorMsg("<p>고객님께서는 기업은행 계좌 미보유로 인해</p><p>해당 거래 진행이 어렵습니다.</p><p>계좌 개설 후 다시 거래 하여 주십시오.</p>");
	    //p.iwin9055.setMsgInfo("조회된 당행 결제계좌가 없습니다.","");
	    
        // 공통 메시지 화면 탭 뷰                 
        p.ChangeTab("9055");
        
		setTimeout(function(){
			ATMCOMM.BusinessEnd(ATMCOMM.RET_NG);
		}, 5000);         
		
		return;				 
	}
	
	let $PN_account = $("div[ui-id='PN_account']");
	// 리스트 초기화
    $PN_account.html("");	
	
	let tag = [], spaceBar="&nbsp;";
	for(let i = 0, k = 0, Len = records.length; i < Len; i++){
	    let record = records[i];
//        console.log("@@@SRN<<<" + record.SRN);  
//        console.log("@@@CUS_ACN<<<" + record.CUS_ACN);   
//        console.log("@@@SUBJ_NM<<<" + record.SUBJ_NM);

		var acctNo = $.trim(record.CUS_ACN); //계좌번호
		
        //기존 결제 계좌일 경우 제외한다.
        if(p.G_custAccStep2.STLM_ACN == acctNo) {
            continue;
        }
        
        var patAcctNo = acctNo.substr(0,3) + "-" + acctNo.substr(3,6) + "-" + acctNo.substr(9,2) + "-" + acctNo.substr(acctNo.length-3);
                            
		tag.push(""
			+'<div class="list_info" onclick="acctSelectStep3(\''+k+'\',\''+acctNo+'\');">'
	        +'	<div class="text_area">'
	        +'    <div class="sub_text">' + record.SUBJ_NM + spaceBar + '</div>'
	        +'    <div class="main_text">' + patAcctNo + '</div>'
	        +'	</div>'
	        +'  <div class="next_img"></div>'
	        +'</div>'	
		);
          					
		k++;
			
	}  // end for - records

	$PN_account.append(""
		+'<div class="list-panel">'
		+tag.join("")
		+'</div>'
	);						
	
	$PN_account.find("> div.list-panel > div.list_info").each(function(i){
		let $this = $(this);
		$this.css({'border': '1px solid #9c9c9c'});
		$this.mousedown(function(){
		    comSelectAnimate.call(this,$("div[ui-id='PN_account'] > div.list-panel > div.list_info"));
		});
	});	
	$PN_account.find("> div.list-panel > div.list_info").css("visibility","visible");		
	
    // 당행 결제계좌 리스트 조회 화면 탭 뷰
	p.ChangeTab("3123");
	
}


// 결제계좌 리스트 클릭 이벤트
function acctSelectStep3(idx,acctNo) {

  console.log(">>>>>>>>>>>>>>>>> acctSelectStep3 === idx === " + idx );		

  let $PN_account = $("div[ui-id='PN_account']");
  
  // 리스트 박스 계좌번호 초기화
  $PN_account.find("> div.list-panel > div.list_info").removeAttr('acctNo');    
    
  // 선택한 박스 계좌번호 셋팅
  $PN_account.find("> div.list-panel > div.list_info:eq("+idx+")").attr('acctNo',acctNo);       
  
  // 확인 버튼 활성화
  BT_right.Enabled = true; 
}

function BT_left_OnClick(e){
	SCREEN.WriteJnl("[결제계좌 선택] 취소");
   	ATMCOMM.BusinessEnd(ATMCOMM.RET_CAN);
}

function BT_right_OnClick(e){
	
  	let $PN_account = $("div[ui-id='PN_account']");
  	$PN_account.find("> div.list-panel > div.list_info").each(function(i)
  	{	 
  		var acctNo = $(this).attr("acctNo");
		//console.log( " acctNo >>>>>> " + acctNo );
		if(!com.util.isNull(acctNo))
		{
			//결제계좌번호
	    	p.G_custAccStep2.STLM_ACN = acctNo;
		}
	});
	// 추가인증 화면 탭 뷰
  	//p.ChangeTab("9041");
  	SCREEN.WriteJnl("**계좌선택: " + p.G_custAccStep2.STLM_ACN);
  	SCREEN.WriteJnl("[결제계좌 선택] 선택");
  	//변경정보 확인
  	p.ChangeTab("3124");
  	p.sendRequest("step4_chgacct_confirm");
}
</script></xjscript></body>
</html>
