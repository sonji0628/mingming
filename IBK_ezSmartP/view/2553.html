<!doctype html>
<html version="1000">
<head>
	<meta charset="utf-8">
	<title>ezSmartAtm Builder Form 새문서</title>
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="expires" content="0">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="author" content="[김윤섭][kkobiboy]">
	<link id="ui-style-core" rel="stylesheet" type="text/css" href="/core/app.controls.css">
	<script type="text/javascript" charset="utf-8" src="/HtaPlatform/Core/Form.JsApi"></script>
	<script type="text/javascript" charset="utf-8" src="/core/app.jquery.js"></script>
	<script type="text/javascript" charset="utf-8" src="/core/app.controls.js"></script>
	<style id="ui-style-user" type="text/css"></style>
	<script id="ui-script-user" type="text/javascript"></script>
</head>
<body oncontextmenu="return false;" class="ui-pre-load"><div class="ui-document ui-container" id="ui-document" lang="kr" ide-size="1310,1024" anchor="0b0101" dock="5" ui-id="Form" ui-class="UIForm" xonload="Form_OnLoad">
<div class="ui-control ui-panel ui-container ui-dock ui-dock-fill" id="ui-171a52210e0" style="left: 0px; top: 0px; width: auto; height: auto; right: 0px; bottom: 0px; z-index: 0; background-color: transparent;" anchor="0b0101" dock="5" ui-id="PN_form" ui-class="UIPanel" dock-r="left:0px;top:0px;width:1280px;height:1024px;right:auto;bottom:auto" dock-h="1024" dock-w="1280"><div class="ui-control ui-panel ui-container ui-dock ui-dock-top" id="ui-171a52210e2" style="left: 0px; top: 0px; width: auto; height: 102px; right: 0px; bottom: auto; z-index: 0; background-color: rgb(23, 107, 200);" anchor="0b0101" dock="1" ui-id="PN_Title" ui-class="UIPanel" dock-r="left:0px;top:0px;width:1280px;height:102px;right:auto;bottom:auto" dock-h="102" dock-w="1280"><span class="ui-control ui-label" id="ui-171a52210e3" style='left: 80px; top: 31px; width: 1120px; height: 40px; right: auto; bottom: auto; color: white; font-family: "IBK iDream M"; font-size: 38px; z-index: 0;' anchor="0b0101" dock="0" ui-id="LB_title" ui-class="UILabel"><span class="ui-content">이체금액</span></span></div><div class="ui-control ui-panel ui-container ui-dock ui-dock-top" id="ui-171a52210e4" style="left: 0px; top: 102px; width: auto; height: 92px; right: 0px; bottom: auto; z-index: 1; background-color: whitesmoke;" anchor="0b0101" dock="1" ui-id="PN_Subtitle" ui-class="UIPanel" dock-r="left:0px;top:102px;width:1280px;height:92px;right:auto;bottom:auto" dock-h="92" dock-w="1280"><span class="ui-control ui-label" id="ui-1737f8f9fff" style='left: 83px; top: 46px; width: 87px; height: 45px; right: auto; bottom: auto; font-family: "IBKIDreamL", "IBK iDream L", sans-serif; font-size: 28px; z-index: 0;' anchor="0b0101" dock="0" ui-id="LB_label1" ui-class="UILabel"><span class="ui-content">맞으면</span></span><span class="ui-control ui-label" id="ui-1737f916311" style='left: 236px; top: 46px; width: 120px; height: 45px; right: auto; bottom: auto; font-family: "IBKIDreamL", "IBK iDream L", sans-serif; font-size: 28px; z-index: 1;' anchor="0b0101" dock="0" ui-id="LB_label2" ui-class="UILabel"><span class="ui-content">을 틀리면</span></span><span class="ui-control ui-label" id="ui-1737f933c29" style='left: 424px; top: 46px; width: 267px; height: 45px; right: auto; bottom: auto; font-family: "IBKIDreamL", "IBK iDream L", sans-serif; font-size: 28px; z-index: 2;' anchor="0b0101" dock="0" ui-id="LB_label8" ui-class="UILabel"><span class="ui-content">을 눌러 주십시오.</span></span><span class="ui-control ui-label" id="ui-1737f92d83a" style='border-radius: 5px; left: 364px; top: 48px; width: 52px; height: 39px; right: auto; bottom: auto; color: white; font-family: "IBK IDream M"; font-size: 22px; z-index: 3; background-color: rgb(0, 104, 196);' anchor="0b0101" dock="0" ui-id="LB_label7" ui-class="UILabel"><span class="ui-content" style="justify-content: center;">정정</span></span><span class="ui-control ui-label" id="ui-171a51593d6" style='border-radius: 5px; left: 177px; top: 48px; width: 52px; height: 39px; right: auto; bottom: auto; color: white; font-family: "IBK IDream M"; font-size: 22px; z-index: 4; background-color: rgb(0, 104, 196);' anchor="0b0101" dock="0" ui-id="LB_label140" ui-class="UILabel"><span class="ui-content" style="justify-content: center;">확인</span></span><span class="ui-control ui-label" id="ui-171a52210e5" style='left: 83px; top: 7px; width: 1120px; height: 45px; right: auto; bottom: auto; font-family: "IBKIDreamL", "IBK iDream L", sans-serif; font-size: 28px; z-index: 5;' anchor="0b0101" dock="0" ui-id="LB_Subtitle1" ui-class="UILabel"><span class="ui-content">이체하실 금액을 눌러 주십시오.</span></span></div><div class="ui-control ui-panel ui-container ui-dock ui-dock-bottom" id="ui-171a52210e8" style="left: 0px; top: auto; width: auto; height: 140px; right: 0px; bottom: 0px; z-index: 2;" anchor="0b0101" dock="2" ui-id="PN_btn" ui-class="UIPanel" dock-r="left:0px;top:884px;width:1280px;height:140px;right:auto;bottom:auto" dock-h="140" dock-w="1280"><span class="ui-control ui-button theme-orange" id="ui-171a52210ea" style='left: 36px; top: 31px; width: 258px; height: 80px; right: auto; bottom: auto; font-family: "IBK iDream M"; font-size: 32px; z-index: 0;' anchor="0b0101" dock="0" ui-id="BT_left" ui-class="UIButton" theme="orange" xonclick="BT_left_OnClick"><span class="ui-content">취소</span></span><span disabled="disabled" class="ui-control ui-button theme-blue ui-disabled" id="ui-171bff71c97" style='left: auto; top: 31px; width: 258px; height: 80px; right: 36px; bottom: auto; font-family: "IBK iDream M"; font-size: 32px; z-index: 1;' anchor="0b1001" dock="0" ui-id="BT_right" ui-class="UIButton" theme="blue" xonclick="BT_right_OnClick"><span class="ui-content">확인</span></span></div><div class="ui-control ui-panel ui-container ui-dock ui-dock-fill" id="ui-174b3b4a37f" style="left: 0px; top: 194px; width: auto; height: auto; right: 0px; bottom: 140px; z-index: 3;" anchor="0b0101" dock="5" ui-id="PN_contents" ui-class="UIPanel" dock-r="left:386px;top:262px;width:200px;height:100px;right:auto;bottom:auto" dock-h="100" dock-w="200"><div class="ui-control ui-numberpad fixed" id="ui-171a5226656" style="left: 714px; top: 124px; width: 352px; height: 487px; right: auto; bottom: auto; z-index: 0;" anchor="0b0101" dock="0" ui-id="NP_numberpad1" ui-class="UINumberPad" xonkeyclick="NP_numberpad1_OnKeyClick"><table class="fixed" border="0" cellspacing="0" cellpadding="0"><tbody><tr><td key="1"><div>1</div></td><td key="2"><div>2</div></td><td key="3"><div>3</div></td></tr><tr><td key="4"><div>4</div></td><td key="5"><div>5</div></td><td key="6"><div>6</div></td></tr><tr><td key="7"><div>7</div></td><td key="8"><div>8</div></td><td key="9"><div>9</div></td></tr><tr><td class="fix backspace" key=""><div></div></td><td key="0"><div>0</div></td><td class="fix clear" key="정정"><div>정정</div></td></tr></tbody></table><table class="shuffle" border="0" cellspacing="0" cellpadding="0"><tbody><tr><td key="2"><div>2</div></td><td class="key-empty" key=""><div></div></td><td key="7"><div>7</div></td><td key="5"><div>5</div></td></tr><tr><td key="3"><div>3</div></td><td key="4"><div>4</div></td><td class="key-empty" key=""><div></div></td><td key="1"><div>1</div></td></tr><tr><td key="6"><div>6</div></td><td key="0"><div>0</div></td><td key="8"><div>8</div></td><td key="9"><div>9</div></td></tr><tr><td class="fix shuffle" colspan="2"><div>재배열</div></td><td class="fix backspace" key="backspace"><div></div></td><td class="fix clear" key="clear"><div>정정</div></td></tr></tbody></table></div><span class="ui-control ui-label" id="ui-171a5245d17" style="left: 134px; top: 254px; width: 134px; height: 32px; right: auto; bottom: auto; color: rgb(2, 111, 206); font-size: 28px; z-index: 1;" anchor="0b0101" dock="0" ui-id="LB_label16" ui-class="UILabel"><span class="ui-content">금액</span></span><span class="ui-control ui-textbox" id="ui-171a52210eb" style="left: 134px; top: 302px; width: 475px; height: 100px; right: auto; bottom: auto; font-size: 38px; z-index: 2;" anchor="0b0101" dock="0" ui-id="TB_transfer" ui-class="UITextBox"><span><input class="ui-input" style="text-align: right;" type="text" maxlength="4" value=""></span></span><span class="ui-control ui-label" id="ui-171bfe7c2a0" style='left: 537px; top: 337px; width: 34px; height: 40px; right: auto; bottom: auto; font-family: "IBK IDream M"; font-size: 32px; z-index: 3;' anchor="0b0101" dock="0" ui-id="LB_label27" ui-class="UILabel"><span class="ui-content">원</span></span></div></div></div><xcomponent></xcomponent><xjscript><script id='xjscript' type='text/plain'>includeJSS("LibCommon","/KRG/0301/common.js"); // LibUtil import
/*
	#2553 - 이체금액 입력
*/
let p = parent;
let moneyBox = TB_transfer;

function Form_OnLoad(e){
	init();
}

// 거래종료
function BT_left_OnClick(e){
	SCREEN.WriteJnl("[이체금액 입력] 취소");
	ATMCOMM.BusinessEnd(ATMCOMM.RET_CAN);
}

// 은행/ 증권사 선택 화면으로 이동
function BT_right_OnClick(e){
	p._TRN_AMT = removeComma(moneyBox.Text); // 전문에 보낼 이체금액
	p._TRN_YMD = p.getNowYMD();
	p._TRN_HMS = p.getNowHMS();
	SCREEN.WriteJnl("**이체금액: " + p._TRN_AMT);
	SCREEN.WriteJnl("[이체금액 입력] 정상");
	// 1. 예금 즉시이체의 경우 은행코드로 자행, 타행이체 구분
	// 2. 적금 추가입금은 자행 이체
	// 예금 즉시이체에서 은행코드값을 받은 경우
	if(p.getOwnBankIs()){
		// 자행
		// CBKEBK848000 자동화기기 수취계좌조회
		p.sendRequest("OwnBankTranCheck");
	} else {
		// CBKEXT112311 자동화기기CD공동망잔액조회
		p.sendRequest("OtherBankTranCheck");
	}
}

// 입력컴포넌트 초기화
function init(){
	// 텍스트박스
	TB_transfer.$.find('>span >.ui-input').attr("disabled","disabled");
	TB_transfer.$.find(">span >.ui-input")
		.attr("placeholder","입력해주세요")
		.attr("readonly","true")
		.attr("disabled","true")
		.css({"padding-right":"15%", "padding-left":"30px"});
		
	// 키패드
	NP_numberpad1.$.find(".backspace").attr("key","backspace");
	btnDisabled();
}

function NP_numberpad1_OnKeyClick(e){
	if(e.key == "정정"){
		e.key='';
		moneyBox.Text = moneyBox.Text.replace(moneyBox.Text,"");
	}
	else if( e.key == "backspace"){
		e.key='';
		moneyBox.Text = NP_numberpad1.autoComma(moneyBox.Text.substring ( 0, moneyBox.Text.length -1));
	} else {
		if(moneyBox.Text == '0') {
			if(e.key == '0') {
				moneyBox.Text = '0';
			} else {
				moneyBox.Text = '';
				moneyBox.Text += e.key;
				moneyBox.Text = NP_numberpad1.autoComma(moneyBox.Text);
			}
		} else {
			moneyBox.Text += e.key;
			moneyBox.Text = NP_numberpad1.autoComma(moneyBox.Text);
		}
	}
	
	//글자수 제한
	if(moneyBox.Text.length == 0){
		notMaxLength();
		btnDisabled();
	} else if(moneyBox.Text.length > 0 && moneyBox.Text.length < 10){
		notMaxLength();
	} else if(moneyBox.Text.length == 10) {
		if(moneyBox.Text.substring (0,1) == 0) {
			moneyBox.Text = moneyBox.Text.substring ( 2, moneyBox.Text.length);
		} else {
			maxLength();
		}
	}
	
	// 확인버튼 enabled & disabled
	if(com.util.isNull(moneyBox.Text) === false){
		if(parseInt(removeComma(moneyBox.Text)) > 0){
			BT_right.Enabled = true;
		} else {
			BT_right.Enabled = false;
		}
	} else {
		BT_right.Enabled = false;
	}
}

//정정 & <- 버튼 disabled 걸기
function btnDisabled(){
	$(".ui-numberpad").find("tbody > tr >td.backspace").css({'background-color':'Transparent'}).addClass('ui-disabled');
	NP_numberpad1.$.find('>table.fixed >tbody >tr >td.clear >div').css({'background-color':'rgb(207, 207, 207)','border':'2px solid #cfcfcf'});
	
	$(".ui-numberpad").find("tbody > tr >td.clear").css({'background-color':'Transparent'}).addClass('ui-disabled');
	NP_numberpad1.$.find('>table.fixed >tbody >tr >td.backspace >div').css({'background-color':'rgb(226, 226, 226)','border':'2px solid #cfcfcf'});			
}


//MaxLength 일때 버튼 disabled
function maxLength(){
	if($(".ui-numberpad").hasClass('fixed')){
		console.log("fn maxLength init!!");
		let length = $('table.fixed').find("tbody > tr >td").length;
		for(let i = 0; i<length; i++){
			let key = $(".ui-numberpad >table.fixed >tbody >tr >td:eq("+i+")").attr('key');			
			if($.isNumeric(key) == true){
			
				$(".ui-numberpad").find("tbody > tr >td:eq("+i+")").css({'background-color':'Transparent'}).addClass('ui-disabled');
				$(".ui-numberpad").find("tbody > tr >td:eq("+i+") >div").css({'background-color':'rgb(237, 238, 240)' ,'opacity':'0.3'});
			}
		}
	}
}


/////////////////////////////////////////////////////////////////////////////////////////
//maxLength가 아닐때 숫자 disabled 풀기
function notMaxLength(){
	if($("[ui-id = 'NP_numberpad1']").hasClass('fixed')){
		let length = $('table.fixed').find("tbody > tr >td").length;
		for(let i = 0; i<length; i++){
			let key = $("table.fixed >tbody >tr >td:eq("+i+")").attr('key');
			if($.isNumeric(key) == true){			
				$('table').find("tbody > tr >td:eq("+i+")").removeClass('ui-disabled');
				$('table').find("tbody > tr >td:eq("+i+") >div").css({'border':'2px solid #cfcfcf','background-color':'#eceef1','color':'#383838','opacity':'1.0'});
				
				//정정 backspace disabled 풀기 css
				NP_numberpad1.$.find('>table.fixed >tbody >tr >td.clear >div').css({'border':'2px solid #00437d','background-color':'#026fce'});
				NP_numberpad1.$.find('>table.fixed >tbody >tr >td.backspace >div').css({'border':'2px solid #2092bc','background-color':'#2eb6e9'});
				
				//정정 backspace 버튼 disabled 풀기
				$(".ui-numberpad").find("tbody > tr >td.clear").css({'background-color':'Transparent'}).removeClass('ui-disabled');
				$(".ui-numberpad").find("tbody > tr >td.backspace").css({'background-color':'Transparent'}).removeClass('ui-disabled');
			}
		}
	}
}

function removeComma(str)
{
	n = parseInt(str.replace(/,/g,""));
	return n;
}</script></xjscript></body>
</html>
