<!doctype html>
<html version="1000">
<head>
	<meta charset="utf-8">
	<title>ezSmartAtm Builder Form 새문서</title>
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="expires" content="0">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="author" content="[김윤섭][kkobiboy]">
	<link id="ui-style-core" rel="stylesheet" type="text/css" href="/core/app.controls.css">
	<script type="text/javascript" charset="utf-8" src="/HtaPlatform/Core/Form.JsApi"></script>
	<script type="text/javascript" charset="utf-8" src="/core/app.jquery.js"></script>
	<script type="text/javascript" charset="utf-8" src="/core/app.controls.js"></script>
	<style id="ui-style-user" type="text/css"></style>
	<script id="ui-script-user" type="text/javascript"></script>
</head>
<body oncontextmenu="return false;" class="ui-pre-load"><div class="ui-document ui-container" id="ui-document" lang="kr" xonload="Form_OnLoad" ide-size="1389,1120" anchor="0b0101" dock="5" ui-id="Form" ui-class="UIForm">
<div class="ui-control ui-panel ui-container" id="ui-171be2e0c07" style="left: 0px; top: 0px; width: 1280px; height: 1024px; right: auto; bottom: auto; z-index: 0; background-color: transparent;" anchor="0b0101" dock="0" ui-id="PN_form" ui-class="UIPanel"><div class="ui-control ui-panel ui-container ui-dock ui-dock-top" id="ui-171be2e0c08" style="left: 0px; top: 0px; width: auto; height: 102px; right: 0px; bottom: auto; z-index: 0; background-color: rgb(23, 107, 200);" anchor="0b0101" dock="1" ui-id="PN_Title" ui-class="UIPanel" dock-r="left:98px;top:1px;width:200px;height:76px;right:auto;bottom:auto" dock-h="102" dock-w="200"><span class="ui-control ui-label" id="ui-171be2e0c09" style='left: 80px; top: 31px; width: 1120px; height: 40px; right: auto; bottom: auto; color: white; font-family: "IBK iDream M"; font-size: 38px; z-index: 0;' anchor="0b0101" dock="0" ui-id="LB_title" ui-class="UILabel"><span class="ui-content">포인트조회/사용신청</span></span></div><div class="ui-control ui-panel ui-container ui-dock ui-dock-top" id="ui-171be2e0c0a" style="left: 0px; top: 102px; width: auto; height: 92px; right: 0px; bottom: auto; z-index: 1; background-color: rgb(239, 240, 242);" anchor="0b0101" dock="1" ui-id="PN_Subtitle" ui-class="UIPanel" dock-r="left:0px;top:102px;width:1280px;height:92px;right:auto;bottom:auto" dock-h="92" dock-w="1280"><span class="ui-control ui-label" id="ui-171be2e0c0b" style='left: 82px; top: 30px; width: 1120px; height: 32px; right: auto; bottom: auto; font-family: "IBK iDream L"; font-size: 28px; z-index: 0;' anchor="0b0101" dock="0" ui-id="LB_Subtitle" ui-class="UILabel"><span class="ui-content">TOP포인트 신청</span></span></div><div class="ui-control ui-panel ui-container ui-dock ui-dock-bottom" id="ui-172729dbaaf" style="left: 0px; top: auto; width: auto; height: 140px; right: 0px; bottom: 0px; z-index: 2;" anchor="0b0101" dock="2" ui-id="PN_btn" ui-class="UIPanel" dock-r="left:0px;top:884px;width:1280px;height:140px;right:auto;bottom:auto" dock-h="140" dock-w="1280"><span class="ui-control ui-button theme-orange" id="ui-172729e45a9" style='left: 36px; top: 31px; width: 258px; height: 80px; right: auto; bottom: auto; font-family: "IBK iDream M"; font-size: 32px; z-index: 0;' anchor="0b0101" dock="0" ui-id="BT_left" ui-class="UIButton" xonclick="BT_left_OnClick" theme="orange"><span class="ui-content">취소</span></span></div><div class="ui-control ui-panel ui-container ui-dock ui-dock-fill" id="ui-172729f3b0f" style="left: 0px; top: 194px; width: auto; height: auto; right: 0px; bottom: 140px; z-index: 3;" anchor="0b0101" dock="5" ui-id="PN_contents" ui-class="UIPanel" dock-r="left:0px;top:194px;width:1280px;height:100px;right:auto;bottom:auto" dock-h="100" dock-w="1280"><span class="ui-control ui-label" id="ui-171770ca3a5" style='left: 81px; top: 38px; width: 1121px; height: 34px; right: auto; bottom: auto; font-family: "Noto sans CJK KR", "맑은 고딕", "Arial", "IBK IDream L", "IBK IDream M", "IBK IDream B", "IBK IDream EB", "IBK IDream Symbol", "IBK IWishR"; font-size: 18px; z-index: 0;' anchor="0b0101" dock="0" ui-id="LB_text" ui-class="UILabel"><span class="ui-content" style="left: 45px; top: 0px; right: 0px; bottom: 0px;">현금캐시백은 결제대금에서 자동 차감되며 결제대금이 없을 경우 결제계좌로 입금됩니다.</span><span class="ui-icon-image" style='background-position: left; background-image: url("/KRG/media/ic_note.png");'></span></span><span class="ui-control ui-label" id="ui-172bfd08218" style='left: 81px; top: 74px; width: 1121px; height: 34px; right: auto; bottom: auto; font-family: "Noto sans CJK KR", "맑은 고딕", "Arial", "IBK IDream L", "IBK IDream M", "IBK IDream B", "IBK IDream EB", "IBK IDream Symbol", "IBK IWishR"; font-size: 18px; z-index: 1;' anchor="0b0101" dock="0" ui-id="LB_label2" ui-class="UILabel"><span class="ui-content" style="left: 45px; top: 0px; right: 0px; bottom: 0px;">대한항공 마일리지는 TOP포인트 20포인트당 1마일로 전환됩니다.</span></span><div class="ui-control ui-panel ui-container" id="ui-171a4b083d4" style="left: 81px; top: 218px; width: 1121px; height: 1px; right: auto; bottom: auto; z-index: 2; background-color: rgb(178, 178, 178);" anchor="0b0101" dock="0" ui-id="PN_panel25" ui-class="UIPanel"></div><span class="ui-control ui-label" id="ui-171aae96368" style="left: 992px; top: 256px; width: 210px; height: 24px; right: auto; bottom: auto; font-size: 21px; z-index: 3;" anchor="0b0101" dock="0" ui-id="LB_label_date" ui-class="UILabel"><span class="ui-content"></span></span><span class="ui-control ui-label" id="ui-171aae96369" style="left: 865px; top: 255px; width: 119px; height: 24px; right: auto; bottom: auto; font-size: 21px; z-index: 4;" anchor="0b0101" dock="0" ui-id="LB_label23" ui-class="UILabel"><span class="ui-content">조회기준일시</span></span><span class="ui-control ui-label" id="ui-171ab4a94c0" style='left: 83px; top: 250px; width: 441px; height: 29px; right: auto; bottom: auto; color: rgb(23, 107, 200); font-family: "IBK iDream M"; font-size: 24px; z-index: 5;' anchor="0b0101" dock="0" ui-id="LB_label44" ui-class="UILabel"><span class="ui-content">보유포인트현황</span></span><div class="ui-control ui-table" id="ui-171ab4d9ef2" style="border-width: 2px; border-color: rgb(194, 194, 194); left: 83px; top: 286px; width: 1121px; height: 53px; right: auto; bottom: auto; z-index: 6;" anchor="0b0101" dock="0" ui-id="TL_table_pt" ui-class="UITable"><table border="0" cellspacing="0" cellpadding="0"><thead><tr><td width="210" type="1" align-v="align-middle" align-h="align-left"></td><td type="1" align-v="align-middle" align-h="align-left"></td></tr></thead><tbody><tr height="100%"><td><div class="ui-table-cell align-left align-middle ui-container" id="ui-172bfdcb06d" style='padding: 0px 0px 0px 20px; font-family: "Noto sans CJK KR", "맑은 고딕", "Arial", "IBK IDream L", "IBK IDream M", "IBK IDream B", "IBK IDream EB", "IBK IDream Symbol", "IBK IWishR"; font-size: 21px; background-color: rgb(242, 242, 242);'><span class="cell-control-label">TOP포인트</span></div></td><td><div class="ui-table-cell align-left align-middle ui-container" id="ui-172bfdcb06e" style="padding: 0px 0px 0px 20px; font-size: 22px;"><span class="cell-control-label">0</span></div></td></tr></tbody></table></div><span class="ui-control ui-label" id="ui-172c00a16b6" style='left: 81px; top: 110px; width: 1121px; height: 34px; right: auto; bottom: auto; font-family: "Noto sans CJK KR", "맑은 고딕", "Arial", "IBK IDream L", "IBK IDream M", "IBK IDream B", "IBK IDream EB", "IBK IDream Symbol", "IBK IWishR"; font-size: 18px; z-index: 7;' anchor="0b0101" dock="0" ui-id="LB_label1" ui-class="UILabel"><span class="ui-content" style="left: 45px; top: 0px; right: 0px; bottom: 0px;">대한항공 마일리지 전환 시 익월 10일 전후로 적용됩니다. (30,000 이상시 사용가능)</span></span><span class="ui-control ui-label" id="ui-172c00c6687" style='left: 83px; top: 365px; width: 441px; height: 42px; right: auto; bottom: auto; color: rgb(23, 107, 200); font-family: "IBK iDream M"; font-size: 24px; z-index: 8;' anchor="0b0101" dock="0" ui-id="LB_label3" ui-class="UILabel"><span class="ui-content">TOP 포인트 사용 신청</span></span><div class="ui-control ui-panel ui-container" id="ui-170ec4084d5" style="left: 83px; top: 422px; width: 1076px; height: 250px; right: auto; bottom: auto; z-index: 9;" anchor="0b0101" dock="0" ui-id="PN_menu" ui-class="UIPanel"></div><span class="ui-control ui-scrollbar" id="ui-172980bda14" style="left: 1200px; top: 422px; width: 32px; height: 250px; right: auto; bottom: auto; z-index: 10;" anchor="0b0101" dock="0" ui-id="SB_scrollbar_menu" ui-class="UIScrollBar" scroll-control-id="PN_menu"><span class="track"></span><span class="trackbutton"></span></span><span class="ui-control ui-label" id="ui-17327377988" style='left: 81px; top: 144px; width: 1121px; height: 34px; right: auto; bottom: auto; font-family: "Noto sans CJK KR", "맑은 고딕", "Arial", "IBK IDream L", "IBK IDream M", "IBK IDream B", "IBK IDream EB", "IBK IDream Symbol", "IBK IWishR"; font-size: 18px; z-index: 11;' anchor="0b0101" dock="0" ui-id="LB_label4" ui-class="UILabel"><span class="ui-content" style="left: 45px; top: 0px; right: 0px; bottom: 0px;">※ 대한항공 마일리지 전환기준 : 포인트 충전/교환 등 카드사용 이외의 방법으로 적립된 포인트는 전환 제외됩니다.</span></span></div></div></div><xcomponent></xcomponent><xjscript><script id='xjscript' type='text/plain'>// 3160.css import
importCSS("3160"     ,"3160.css");

// common.js import
importJSS("common", "common.js");

var p = parent;
    
function Form_OnLoad(e){

}


// TOP포인트 리스트
function topPointList(xioOutput) {

	// 리스트 초기화
	let $PN_menu = $("div[ui-id='PN_menu']");
    $PN_menu.html("");	
    
	let tag = [];    

	const records = xioOutput.Grid1;
	for(let i = 0, Len = records.length; i < Len; i++){
	    let record = records[i];
        console.log("포인트명 >>> " + record.PNT_NM);  // 포인트명
        console.log("잔여포인트 >>> " + record.RMNG_PNT);  //  잔여포인트
        console.log("PNT_KCD >>> " + record.PNT_KCD); 
        // 전환 가능 포인트
        console.log("전환 가능 포인트 >>>> " + com.util.fnGetFormatMoney(parseInt(record.RMNG_PNT))); 
        
        // TOP 포인트 표시
        if(record.PNT_KCD == "000000"){
		   // 전환 가능 포인트
           TL_table_pt.DataCell(0,1,"text",com.util.fnGetFormatMoney(parseInt(record.RMNG_PNT)) );

           const topBackPoint = parseInt(record.RMNG_PNT);

			tag.push(""
				+'<div class="list_info" onclick="topPointSelect(\''+i+'\',\''+topBackPoint+'\', \'CASH\');">'
		        +'	<div class="text_area">'
		        +'    <div class="main_text menu_txt">현금 캐시백 신청 (전환가능 포인트 : ' + com.util.fnGetFormatMoney(topBackPoint) + ')</div>'
		        +'	</div>'
		        +'  <div class="next_img"></div>'
		        +'</div>'	
			);                     

			$PN_menu.append(""
				+'<div class="list-panel cash disabled">'
				+tag.join("")
				+'</div>'
			);
			
            if(parseInt(topBackPoint) > 0 ) { 
			   //보유포인트가 있을때만 disabled 해제
			   $PN_menu.find("> div.list-panel").removeClass("disabled");
            }					
        }  // end if - record.PNT_KCD	                
	}  // end for - records			

}


// 대한항공 마일리지 리스트
function airPointList(xioOutput) {

	// 리스트 초기화
	let $PN_menu = $("div[ui-id='PN_menu']");
    
	let tag = [];

	console.log("searchCardPointDtlAirStep3 PNT_RMNG_HST_ROWCOUNT : " + xioOutput.PNT_RMNG_HST_ROWCOUNT);
	console.log("searchCardPointDtlAirStep3 Grid1 : " + xioOutput.Grid1);
	 								
	const records = xioOutput.Grid1;
	for(let i = 0, Len = records.length; i < Len; i++){
	    let record = records[i];
        console.log("포인트명 >>>> " + record.PNT_NM);  // 포인트명
        console.log("잔여포인트 >>>> " + record.RMNG_PNT);  //  잔여포인트
        
        // TOP 포인트 표시
        if(record.PNT_KCD == "000000"){
        
           const mileBackPoint = parseInt(record.RMNG_PNT);
                                       
		   tag.push(""
				+'<div class="list_info" onclick="airPointSelect(\''+i+'\',\''+mileBackPoint+'\', \'AIR\');">'
		        +'	<div class="text_area">'
		        +'    <div class="main_text menu_txt">대한항공 마일리지 전환 (전환가능 포인트 : ' + com.util.fnGetFormatMoney(mileBackPoint) + ')</div>'
		        +'	</div>'
		        +'  <div class="next_img"></div>'
		        +'</div>'	
			);                     
                                                          
			$PN_menu.append(""
				+'<div class="list-panel air disabled">'
				+tag.join("")
				+'</div>'
			);
			
			$PN_menu.find("> div.list-panel > div.list_info").each(function(i){
				let $this = $(this);
				$this.css({'border': '1px solid #9c9c9c'});
				$this.mousedown(function(){
				    comSelectAnimate.call(this,$("div[ui-id='PN_menu'] > div.list-panel > div.list_info"));
				});
			});
			$PN_menu.find("> div.list-panel > div.list_info").css("visibility","visible");				
			
            if(parseInt(mileBackPoint) >= 30000 ) {
			   // TOP 포인트 항공 마일리지 반환 (최소 30000 포인트 이상 그보다 적을 경우, 전환 불가능)
			   $PN_menu.find("> div.list-panel").removeClass("disabled");
            }
            
        }  // end if - record.PNT_KCD	                
        
	}  // end for - records				

}


// TOP포인트 리스트 클릭 이벤트
function topPointSelect(idx,point,act) {

   console.log(">>>>>>>>>>>>>>>>> topPointSelect === idx === " + idx );		
   console.log(">>>>>>>>>>>>>>>>> topPointSelect === point === " + point );		
   console.log(">>>>>>>>>>>>>>>>> topPointSelect === act === " + act );		
   SCREEN.WriteJnl("[TOP 포인트 사용 신청] 선택");
   // 화면로딩 탭 뷰
   p.ChangeTab(p.loadScreenNo);
   // 전환 가능 포인트 셋팅
   p.G_cardInfoAvailablePointTopStep3 = point;
   // 실행 구분(CASH:현금캐시백,AIR:대한항공 마일리지)
   p.G_actStep3 = act;
   // 포인트 사용신청 - 캐시백 사용 신청 화면 조회
   p.sendRequest("step4_point_cashuse_chk");
}


// 대한항공 마일리지 리스트 클릭 이벤트
function airPointSelect(idx,point,act) {

   console.log(">>>>>>>>>>>>>>>>> airPointSelect === idx === " + idx );		
   console.log(">>>>>>>>>>>>>>>>> airPointSelect === point === " + point );		
   console.log(">>>>>>>>>>>>>>>>> airPointSelect === act === " + act );
   SCREEN.WriteJnl("[대한항공 마일리지 사용 신청] 선택");
   // 화면로딩 탭 뷰
   p.ChangeTab(p.loadScreenNo);
   // 전환 가능 포인트 셋팅
   p.G_cardInfoAvailablePointTopStep3 = point;
   // 실행 구분(CASH:현금캐시백,AIR:대한항공 마일리지)
   p.G_actStep3 = act;
   // 대한항공 마일리지 사용 신청 화면 조회
   p.sendRequest("step4_point_airuse_chk");
}


function BT_left_OnClick(e){
	SCREEN.WriteJnl("[TOP 포인트 신청] 취소");
   	ATMCOMM.BusinessEnd(ATMCOMM.RET_CAN);
}</script></xjscript></body>
</html>
